<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>More Than Two Weeks Stock - Smart Inventory Management System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .graph-container {
            display: flex;
            flex-wrap: wrap;
            gap: 2rem;
            margin-top: 2rem;
        }
        .graph-card {
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 1.5rem;
            width: calc(50% - 1rem);
        }
        .report-container {
            margin-top: 2rem;
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 1.5rem;
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="container">
            <div class="nav-content">
                <div class="logo">
                    <span class="logo-text">Smart Inventory</span>
                </div>
                <div class="nav-links">
                    <div class="nav-item">
                        <a href="dashboard.html">Home</a>
                    </div>
                    <div class="nav-item">
                        <a href="products.html">Products</a>
                    </div>
                    <div class="nav-item">
                        <a href="sales.html">Sales</a>
                    </div>
                    <div class="nav-item">
                        <a href="inventory.html">Inventory</a>
                    </div>
                    <div class="nav-item">
                        <a href="invoices.html">Invoices</a>
                    </div>
                    <div class="nav-item">
                        <a href="index.html" class="signout-btn">Sign Out</a>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <div class="dashboard-container">
        <div class="container">
            <h1 class="dashboard-title">Products with More Than Two Weeks Stock</h1>
             <!-- Added search and sort functionality -->
             <div class="search-sort-container">
                <div class="search-container">
                    <i class="fas fa-search search-icon"></i>
                    <input type="text" id="productSearch" placeholder="Search products..." class="search-input">
                </div>
                <div class="sort-container">
                    <select id="productSort">
                        <option value="default">Default Order</option>
                        <option value="nameAsc">Name (A-Z)</option>
                        <option value="nameDesc">Name (Z-A)</option>
                    </select>
                </div>
            </div>
            
            <div class="info-banner bg-green-100 border-l-4 border-green-500 p-4 mb-6">
                <div class="flex">
                    <div class="flex-shrink-0">
                        <i class="fas fa-check-circle text-green-500"></i>
                    </div>
                    <div class="ml-3">
                        <p class="text-sm text-green-700">
                            These products have healthy stock levels with more than two weeks of inventory based on current sales velocity.
                        </p>
                    </div>
                </div>
            </div>
            
            <div class="table-container">
                <table class="data-table" id="productsTable">
                    <thead>
                        <tr>
                            <th>Product Name</th>
                            <th>MRP</th>
                            <th>Predicted Price</th>
                            <th>Stock</th>
                            <th>Quantity Prediction</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Product C</td>
                            <td>₹500</td>
                            <td>₹480</td>
                            <td>300</td>
                            <td>250</td>
                            <td>
                                <a href="vendors.html?product=Product%20C" class="action-btn">Contact Vendors</a>
                                <a href="inventory.html?product=Product%20C" class="action-btn">Analysis</a>
                            </td>
                        </tr>
                        <tr>
                            <td>Product I</td>
                            <td>₹950</td>
                            <td>₹920</td>
                            <td>450</td>
                            <td>200</td>
                            <td>
                                <a href="vendors.html?product=Product%20I" class="action-btn">Contact Vendors</a>
                                <a href="inventory.html?product=Product%20I" class="action-btn">Analysis</a>
                            </td>
                        </tr>
                        <tr>
                            <td>Product J</td>
                            <td>₹1500</td>
                            <td>₹1450</td>
                            <td>250</td>
                            <td>100</td>
                            <td>
                                <a href="vendors.html?product=Product%20J" class="action-btn">Contact Vendors</a>
                                <a href="inventory.html?product=Product%20J" class="action-btn">Analysis</a>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- New Graph Section -->
        <div class="container">
            <div class="graph-container">
                <div class="graph-card">
                    <h2 class="text-xl font-semibold mb-4">Well-Stocked Products Trend (Last 30 Days)</h2>
                    <canvas id="wellStockedTrendChart"></canvas>
                </div>
                <div class="graph-card">
                    <h2 class="text-xl font-semibold mb-4">Capital Allocation Analysis</h2>
                    <canvas id="capitalAllocationChart"></canvas>
                </div>
            </div>
            
            <!-- Report Section -->
            <div class="report-container">
                <h2 class="text-xl font-semibold mb-4">Excess Inventory Analysis Report</h2>
                <div style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 6px; padding: 1rem; font-family: 'Inter', sans-serif;">
                    <p class="mb-2">Your store has 20 products with more than two weeks of stock. Key insights:</p>
                    <ul style="list-style-type: disc; padding-left: 1.5rem; margin-bottom: 1rem;">
                        <li>20 products have more than 14 days of inventory at current sales rates</li>
                        <li>Total capital locked in excess inventory: ₹125,000</li>
                        <li>Products J, K, and L have shown declining demand over the past month</li>
                        <li>Storage cost for these excess items: approximately ₹8,500 per month</li>
                    </ul>
                    <p class="mb-2">Recommendations:</p>
                    <ul style="list-style-type: disc; padding-left: 1.5rem; margin-bottom: 1rem;">
                        <li>Consider running a promotion for slow-moving Products J, K, and L</li>
                        <li>Reduce next order quantities by 30% for these over-stocked items</li>
                        <li>Reallocate approximately ₹40,000 of inventory capital to faster-moving products</li>
                        <li>Review product lifecycle stage for items with consistently excessive stock</li>
                    </ul>
                    <p style="color: #6b7280; font-style: italic; margin-top: 0.5rem;">This analysis will be dynamically generated via LLM API integration based on your actual shop data.</p>
                </div>
                
                <div style="display: flex; justify-content: flex-end; margin-top: 1.5rem;">
                    <button style="background-color: #4f46e5; color: white; font-weight: 500; padding: 0.5rem 1rem; border-radius: 6px; display: flex; align-items: center; gap: 0.5rem;">
                        <i class="fas fa-download"></i> Export Report
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Search functionality
            const searchInput = document.getElementById('productSearch');
            searchInput.addEventListener('input', function() {
                const searchTerm = this.value.toLowerCase();
                const tableRows = document.querySelectorAll('#productsTable tbody tr');
                
                tableRows.forEach(row => {
                    const productName = row.querySelector('td:first-child').textContent.toLowerCase();
                    if (productName.includes(searchTerm)) {
                        row.style.display = '';
                    } else {
                        row.style.display = 'none';
                    }
                });
            });
            
            // Sorting functionality
            const sortSelect = document.getElementById('productSort');
            sortSelect.addEventListener('change', function() {
                const sortValue = this.value;
                const tableBody = document.querySelector('#productsTable tbody');
                const rows = Array.from(tableBody.querySelectorAll('tr'));
                
                if (sortValue === 'nameAsc') {
                    rows.sort((a, b) => {
                        const aName = a.querySelector('td:first-child').textContent;
                        const bName = b.querySelector('td:first-child').textContent;
                        return aName.localeCompare(bName);
                    });
                } else if (sortValue === 'nameDesc') {
                    rows.sort((a, b) => {
                        const aName = a.querySelector('td:first-child').textContent;
                        const bName = b.querySelector('td:first-child').textContent;
                        return bName.localeCompare(aName);
                    });
                } else {
                    // Default sorting (by original order)
                    rows.sort((a, b) => {
                        return Array.from(tableBody.querySelectorAll('tr')).indexOf(a) - 
                               Array.from(tableBody.querySelectorAll('tr')).indexOf(b);
                    });
                }
                
                // Clear and re-append sorted rows
                while (tableBody.firstChild) {
                    tableBody.removeChild(tableBody.firstChild);
                }
                
                rows.forEach(row => tableBody.appendChild(row));
            });

            // Well-Stocked Products Trend Line Chart
            const wellStockedCtx = document.getElementById('wellStockedTrendChart').getContext('2d');
            const wellStockedTrendChart = new Chart(wellStockedCtx, {
                type: 'line',
                data: {
                    labels: Array.from({length: 30}, (_, i) => `Day ${i+1}`),
                    datasets: [{
                        label: 'Well-Stocked Products',
                        data: [18, 19, 18, 17, 18, 19, 20, 19, 18, 19, 20, 21, 20, 19, 20, 21, 22, 21, 20, 19, 20, 21, 20, 19, 18, 19, 20, 21, 20, 20],
                        borderColor: '#22c55e',
                        backgroundColor: 'rgba(34, 197, 94, 0.1)',
                        tension: 0.3,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'top'
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                            callbacks: {
                                label: function(context) {
                                    return `Products: ${context.raw}`;
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Number of Products'
                            },
                            ticks: {
                                stepSize: 1
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Last 30 Days'
                            }
                        }
                    }
                }
            });
            
            // Capital Allocation Chart
            const capitalCtx = document.getElementById('capitalAllocationChart').getContext('2d');
            const capitalAllocationChart = new Chart(capitalCtx, {
                type: 'line',
                data: {
                    labels: Array.from({length: 30}, (_, i) => `Day ${i+1}`),
                    datasets: [{
                        label: 'Capital in Excess Inventory',
                        data: [
                            110000, 115000, 112000, 108000, 112000, 118000, 125000, 120000, 115000, 
                            118000, 125000, 130000, 125000, 120000, 125000, 130000, 135000, 130000, 
                            125000, 120000, 125000, 130000, 125000, 120000, 115000, 120000, 125000, 
                            130000, 125000, 125000
                        ],
                        borderColor: '#3b82f6',
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        tension: 0.3,
                        fill: true
                    }, {
                        label: 'Optimal Capital Allocation',
                        data: Array(30).fill(85000),
                        borderColor: '#22c55e',
                        backgroundColor: 'rgba(34, 197, 94, 0.1)',
                        borderDash: [5, 5],
                        tension: 0,
                        fill: false
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'top'
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                            callbacks: {
                                label: function(context) {
                                    return `${context.dataset.label}: ₹${context.raw.toLocaleString()}`;
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: false,
                            title: {
                                display: true,
                                text: 'Capital Amount (₹)'
                            },
                            ticks: {
                                callback: function(value) {
                                    return '₹' + (value / 1000) + 'K';
                                }
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Last 30 Days'
                            }
                        }
                    }
                }
            });
        });
    </script>   
</body>
</html> 