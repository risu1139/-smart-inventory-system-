<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Two Weeks Stock Products - Smart Inventory Management System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .graph-container {
            display: flex;
            flex-wrap: wrap;
            gap: 2rem;
            margin-top: 2rem;
        }
        .graph-card {
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 1.5rem;
            width: calc(50% - 1rem);
        }
        .report-container {
            margin-top: 2rem;
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 1.5rem;
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="container">
            <div class="nav-content">
                <div class="logo">
                    <span class="logo-text">Smart Inventory</span>
                </div>
                <div class="nav-links">
                    <div class="nav-item">
                        <a href="dashboard.html">Home</a>
                    </div>
                    <div class="nav-item">
                        <a href="products.html">Products</a>
                    </div>
                    <div class="nav-item">
                        <a href="sales.html">Sales</a>
                    </div>
                    <div class="nav-item">
                        <a href="inventory.html">Inventory</a>
                    </div>
                    <div class="nav-item">
                        <a href="invoices.html">Invoices</a>
                    </div>
                    <div class="nav-item">
                        <a href="index.html" class="signout-btn">Sign Out</a>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <div class="dashboard-container">
        <div class="container">
            <h1 class="dashboard-title">Products with Two Weeks Stock</h1>
             <!-- Added search and sort functionality -->
             <div class="search-sort-container">
                <div class="search-container">
                    <i class="fas fa-search search-icon"></i>
                    <input type="text" id="productSearch" placeholder="Search products..." class="search-input">
                </div>
                <div class="sort-container">
                    <select id="productSort">
                        <option value="default">Default Order</option>
                        <option value="nameAsc">Name (A-Z)</option>
                        <option value="nameDesc">Name (Z-A)</option>
                    </select>
                </div>
            </div>
            
            <div class="info-banner bg-yellow-100 border-l-4 border-yellow-500 p-4 mb-6">
                <div class="flex">
                    <div class="flex-shrink-0">
                        <i class="fas fa-info-circle text-yellow-500"></i>
                    </div>
                    <div class="ml-3">
                        <p class="text-sm text-yellow-700">
                            These products have approximately two weeks of stock remaining based on current sales velocity.
                        </p>
                    </div>
                </div>
            </div>
            
            <div class="table-container">
                <table class="data-table" id="productsTable">
                    <thead>
                        <tr>
                            <th>Product Name</th>
                            <th>MRP</th>
                            <th>Predicted Price</th>
                            <th>Stock</th>
                            <th>Quantity Prediction</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Product G</td>
                            <td>₹1800</td>
                            <td>₹1750</td>
                            <td>120</td>
                            <td>150</td>
                            <td>
                                <a href="vendors.html?product=Product%20G" class="action-btn">Contact Vendors</a>
                                <a href="inventory.html?product=Product%20G" class="action-btn">Analysis</a>
                            </td>
                        </tr>
                        <tr>
                            <td>Product H</td>
                            <td>₹3200</td>
                            <td>₹3100</td>
                            <td>85</td>
                            <td>100</td>
                            <td>
                                <a href="vendors.html?product=Product%20H" class="action-btn">Contact Vendors</a>
                                <a href="inventory.html?product=Product%20H" class="action-btn">Analysis</a>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- New Graph Section -->
        <div class="container">
            <div class="graph-container">
                <div class="graph-card">
                    <h2 class="text-xl font-semibold mb-4">Two Week Stock Products Trend (Last 30 Days)</h2>
                    <canvas id="twoWeekStockTrendChart"></canvas>
                </div>
                <div class="graph-card">
                    <h2 class="text-xl font-semibold mb-4">Potential Future Impact Assessment</h2>
                    <canvas id="futureImpactChart"></canvas>
                </div>
            </div>
            
            <!-- Report Section -->
            <div class="report-container">
                <h2 class="text-xl font-semibold mb-4">Two Week Stock Analysis Report</h2>
                <div style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 6px; padding: 1rem; font-family: 'Inter', sans-serif;">
                    <p class="mb-2">Your store has 15 products with two weeks of stock remaining. Key insights:</p>
                    <ul style="list-style-type: disc; padding-left: 1.5rem; margin-bottom: 1rem;">
                        <li>15 products have approximately 8-14 days of inventory at current sales rates</li>
                        <li>Potential revenue impact if not reordered on time: ₹25,000</li>
                        <li>Products H and I are approaching seasonal peak demand periods</li>
                        <li>Average reorder lead time for these products: 7-10 days</li>
                    </ul>
                    <p class="mb-2">Recommendations:</p>
                    <ul style="list-style-type: disc; padding-left: 1.5rem; margin-bottom: 1rem;">
                        <li>Initiate reorder process for Products H and I within 3 days</li>
                        <li>Schedule regular inventory reviews for these items on Monday mornings</li>
                        <li>Consider increasing reorder quantity by 15% for seasonal items to buffer against demand spikes</li>
                    </ul>
                    <p style="color: #6b7280; font-style: italic; margin-top: 0.5rem;">This analysis will be dynamically generated via LLM API integration based on your actual shop data.</p>
                </div>
                
                <div style="display: flex; justify-content: flex-end; margin-top: 1.5rem;">
                    <button style="background-color: #4f46e5; color: white; font-weight: 500; padding: 0.5rem 1rem; border-radius: 6px; display: flex; align-items: center; gap: 0.5rem;">
                        <i class="fas fa-download"></i> Export Report
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Search functionality
            const searchInput = document.getElementById('productSearch');
            searchInput.addEventListener('input', function() {
                const searchTerm = this.value.toLowerCase();
                const tableRows = document.querySelectorAll('#productsTable tbody tr');
                
                tableRows.forEach(row => {
                    const productName = row.querySelector('td:first-child').textContent.toLowerCase();
                    if (productName.includes(searchTerm)) {
                        row.style.display = '';
                    } else {
                        row.style.display = 'none';
                    }
                });
            });
            
            // Sorting functionality
            const sortSelect = document.getElementById('productSort');
            sortSelect.addEventListener('change', function() {
                const sortValue = this.value;
                const tableBody = document.querySelector('#productsTable tbody');
                const rows = Array.from(tableBody.querySelectorAll('tr'));
                
                if (sortValue === 'nameAsc') {
                    rows.sort((a, b) => {
                        const aName = a.querySelector('td:first-child').textContent;
                        const bName = b.querySelector('td:first-child').textContent;
                        return aName.localeCompare(bName);
                    });
                } else if (sortValue === 'nameDesc') {
                    rows.sort((a, b) => {
                        const aName = a.querySelector('td:first-child').textContent;
                        const bName = b.querySelector('td:first-child').textContent;
                        return bName.localeCompare(aName);
                    });
                } else {
                    // Default sorting (by original order)
                    rows.sort((a, b) => {
                        return Array.from(tableBody.querySelectorAll('tr')).indexOf(a) - 
                               Array.from(tableBody.querySelectorAll('tr')).indexOf(b);
                    });
                }
                
                // Clear and re-append sorted rows
                while (tableBody.firstChild) {
                    tableBody.removeChild(tableBody.firstChild);
                }
                
                rows.forEach(row => tableBody.appendChild(row));
            });

            // Two Week Stock Trend Line Chart
            const twoWeekStockCtx = document.getElementById('twoWeekStockTrendChart').getContext('2d');
            const twoWeekStockTrendChart = new Chart(twoWeekStockCtx, {
                type: 'line',
                data: {
                    labels: Array.from({length: 30}, (_, i) => `Day ${i+1}`),
                    datasets: [{
                        label: 'Two Week Stock Products',
                        data: [12, 13, 14, 15, 15, 14, 15, 16, 15, 14, 13, 15, 16, 15, 14, 15, 16, 15, 14, 15, 16, 15, 14, 15, 16, 15, 14, 15, 16, 15],
                        borderColor: '#facc15',
                        backgroundColor: 'rgba(250, 204, 21, 0.1)',
                        tension: 0.3,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'top'
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                            callbacks: {
                                label: function(context) {
                                    return `Products: ${context.raw}`;
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Number of Products'
                            },
                            ticks: {
                                stepSize: 1
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Last 30 Days'
                            }
                        }
                    }
                }
            });
            
            // Future Impact Chart
            const futureCtx = document.getElementById('futureImpactChart').getContext('2d');
            const futureImpactChart = new Chart(futureCtx, {
                type: 'line',
                data: {
                    labels: Array.from({length: 14}, (_, i) => `Day ${i+1}`),
                    datasets: [{
                        label: 'Forecasted Daily Revenue',
                        data: [
                            12000, 12500, 13000, 13500, 14000, 14500, 15000, 
                            15500, 16000, 16500, 17000, 17500, 18000, 18500
                        ],
                        borderColor: '#3b82f6',
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        tension: 0.3,
                        fill: true
                    }, {
                        label: 'Revenue at Risk',
                        data: [
                            0, 0, 0, 0, 0, 0, 0,
                            2000, 4000, 6000, 8000, 10000, 12000, 14000
                        ],
                        borderColor: '#f97316',
                        backgroundColor: 'rgba(249, 115, 22, 0.3)',
                        tension: 0.3,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'top'
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                            callbacks: {
                                label: function(context) {
                                    return `${context.dataset.label}: ₹${context.raw.toLocaleString()}`;
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            stacked: false,
                            title: {
                                display: true,
                                text: 'Revenue (₹)'
                            },
                            ticks: {
                                callback: function(value) {
                                    return '₹' + value.toLocaleString();
                                }
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Next 14 Days'
                            }
                        }
                    }
                }
            });
        });
    </script>   
</body>
</html> 