<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>One Week Stock Products - Smart Inventory Management System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .graph-container {
            display: flex;
            flex-wrap: wrap;
            gap: 2rem;
            margin-top: 2rem;
        }
        .graph-card {
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 1.5rem;
            width: calc(50% - 1rem);
        }
        .report-container {
            margin-top: 2rem;
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 1.5rem;
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="container">
            <div class="nav-content">
                <div class="logo">
                    <span class="logo-text">Smart Inventory</span>
                </div>
                <div class="nav-links">
                    <div class="nav-item">
                        <a href="dashboard.html">Home</a>
                    </div>
                    <div class="nav-item">
                        <a href="products.html">Products</a>
                    </div>
                    <div class="nav-item">
                        <a href="sales.html">Sales</a>
                    </div>
                    <div class="nav-item">
                        <a href="inventory.html">Inventory</a>
                    </div>
                    <div class="nav-item">
                        <a href="invoices.html">Invoices</a>
                    </div>
                    <div class="nav-item">
                        <a href="index.html" class="signout-btn">Sign Out</a>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <div class="dashboard-container">
        <div class="container">
            <h1 class="dashboard-title">Products with One Week Stock</h1>
            <!-- Added search and sort functionality -->
            <div class="search-sort-container">
                <div class="search-container">
                    <i class="fas fa-search search-icon"></i>
                    <input type="text" id="productSearch" placeholder="Search products..." class="search-input">
                </div>
                <div class="sort-container">
                    <select id="productSort">
                        <option value="default">Default Order</option>
                        <option value="nameAsc">Name (A-Z)</option>
                        <option value="nameDesc">Name (Z-A)</option>
                    </select>
                </div>
            </div>
            
            <div class="table-container">
                <table class="data-table" id="productsTable">
                    <thead>
                        <tr>
                            <th>Product Name</th>
                            <th>MRP</th>
                            <th>Predicted Price</th>
                            <th>Stock</th>
                            <th>Quantity Prediction</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Product F</td>
                            <td>₹850</td>
                            <td>₹820</td>
                            <td>25</td>
                            <td>75</td>
                            <td>
                                <a href="vendors.html?product=Product%20F" class="action-btn">Contact Vendors</a>
                                <a href="inventory.html?product=Product%20F" class="action-btn">Analysis</a>
                            </td>
                        </tr>
                        <tr>
                            <td>Product B</td>
                            <td>₹2500</td>
                            <td>₹2400</td>
                            <td>75</td>
                            <td>100</td>
                            <td>
                                <a href="vendors.html?product=Product%20B" class="action-btn">Contact Vendors</a>
                                <a href="inventory.html?product=Product%20B" class="action-btn">Analysis</a>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- New Graph Section -->
        <div class="container">
            <div class="graph-container">
                <div class="graph-card">
                    <h2 class="text-xl font-semibold mb-4">One Week Stock Products Trend (Last 30 Days)</h2>
                    <canvas id="oneWeekStockTrendChart"></canvas>
                </div>
                <div class="graph-card">
                    <h2 class="text-xl font-semibold mb-4">Potential Loss Risk Assessment</h2>
                    <canvas id="riskAssessmentChart"></canvas>
                </div>
            </div>
            
            <!-- Report Section -->
            <div class="report-container">
                <h2 class="text-xl font-semibold mb-4">One Week Stock Analysis Report</h2>
                <div style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 6px; padding: 1rem; font-family: 'Inter', sans-serif;">
                    <p class="mb-2">Your store has 10 products with only one week of stock remaining. Key insights:</p>
                    <ul style="list-style-type: disc; padding-left: 1.5rem; margin-bottom: 1rem;">
                        <li>10 products have less than 7 days of inventory at current sales rates</li>
                        <li>Potential revenue at risk if stockout occurs: ₹35,000</li>
                        <li>Products F and G have shown a 20% increase in demand over the last week</li>
                        <li>Current reorder timeline for these products: 5 days (cutting it close)</li>
                    </ul>
                    <p class="mb-2">Recommendations:</p>
                    <ul style="list-style-type: disc; padding-left: 1.5rem; margin-bottom: 1rem;">
                        <li>Place orders for Products F and G immediately with expedited shipping</li>
                        <li>Consider implementing a tiered inventory alert system for these fast-moving items</li>
                        <li>Run a small promotion for alternative products to shift demand while stock replenishes</li>
                    </ul>
                    <p style="color: #6b7280; font-style: italic; margin-top: 0.5rem;">This analysis will be dynamically generated via LLM API integration based on your actual shop data.</p>
                </div>
                
                <div style="display: flex; justify-content: flex-end; margin-top: 1.5rem;">
                    <button style="background-color: #4f46e5; color: white; font-weight: 500; padding: 0.5rem 1rem; border-radius: 6px; display: flex; align-items: center; gap: 0.5rem;">
                        <i class="fas fa-download"></i> Export Report
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Search functionality
            const searchInput = document.getElementById('productSearch');
            searchInput.addEventListener('input', function() {
                const searchTerm = this.value.toLowerCase();
                const tableRows = document.querySelectorAll('#productsTable tbody tr');
                
                tableRows.forEach(row => {
                    const productName = row.querySelector('td:first-child').textContent.toLowerCase();
                    if (productName.includes(searchTerm)) {
                        row.style.display = '';
                    } else {
                        row.style.display = 'none';
                    }
                });
            });
            
            // Sorting functionality
            const sortSelect = document.getElementById('productSort');
            sortSelect.addEventListener('change', function() {
                const sortValue = this.value;
                const tableBody = document.querySelector('#productsTable tbody');
                const rows = Array.from(tableBody.querySelectorAll('tr'));
                
                if (sortValue === 'nameAsc') {
                    rows.sort((a, b) => {
                        const aName = a.querySelector('td:first-child').textContent;
                        const bName = b.querySelector('td:first-child').textContent;
                        return aName.localeCompare(bName);
                    });
                } else if (sortValue === 'nameDesc') {
                    rows.sort((a, b) => {
                        const aName = a.querySelector('td:first-child').textContent;
                        const bName = b.querySelector('td:first-child').textContent;
                        return bName.localeCompare(aName);
                    });
                } else {
                    // Default sorting (by original order)
                    rows.sort((a, b) => {
                        return Array.from(tableBody.querySelectorAll('tr')).indexOf(a) - 
                               Array.from(tableBody.querySelectorAll('tr')).indexOf(b);
                    });
                }
                
                // Clear and re-append sorted rows
                while (tableBody.firstChild) {
                    tableBody.removeChild(tableBody.firstChild);
                }
                
                rows.forEach(row => tableBody.appendChild(row));
            });

            // One Week Stock Trend Line Chart
            const oneWeekStockCtx = document.getElementById('oneWeekStockTrendChart').getContext('2d');
            const oneWeekStockTrendChart = new Chart(oneWeekStockCtx, {
                type: 'line',
                data: {
                    labels: Array.from({length: 30}, (_, i) => `Day ${i+1}`),
                    datasets: [{
                        label: 'One Week Stock Products',
                        data: [7, 8, 9, 10, 9, 8, 7, 9, 10, 11, 10, 9, 10, 11, 12, 10, 9, 10, 10, 11, 9, 10, 9, 8, 9, 10, 11, 10, 10, 10],
                        borderColor: '#f97316',
                        backgroundColor: 'rgba(249, 115, 22, 0.1)',
                        tension: 0.3,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'top'
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                            callbacks: {
                                label: function(context) {
                                    return `Products: ${context.raw}`;
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Number of Products'
                            },
                            ticks: {
                                stepSize: 1
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Last 30 Days'
                            }
                        }
                    }
                }
            });
            
            // Risk Assessment Line Chart
            const riskCtx = document.getElementById('riskAssessmentChart').getContext('2d');
            const riskAssessmentChart = new Chart(riskCtx, {
                type: 'line',
                data: {
                    labels: Array.from({length: 30}, (_, i) => `Day ${i+1}`),
                    datasets: [{
                        label: 'Daily Potential Loss',
                        data: [
                            3500, 4000, 4500, 5000, 4500, 4000, 3500, 4500, 5000, 5500, 5000, 
                            4500, 5000, 5500, 6000, 5000, 4500, 5000, 5000, 5500, 4500, 5000, 
                            4500, 4000, 4500, 5000, 5500, 5000, 5000, 5000
                        ],
                        borderColor: '#facc15',
                        backgroundColor: 'rgba(250, 204, 21, 0.1)',
                        tension: 0.3,
                        fill: true
                    }, {
                        label: 'Reorder Cost',
                        data: Array(30).fill(2500),
                        borderColor: '#22c55e',
                        backgroundColor: 'rgba(34, 197, 94, 0.1)',
                        borderDash: [5, 5],
                        tension: 0,
                        fill: false
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'top'
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                            callbacks: {
                                label: function(context) {
                                    return `${context.dataset.label}: ₹${context.raw.toLocaleString()}`;
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Amount (₹)'
                            },
                            ticks: {
                                callback: function(value) {
                                    return '₹' + value.toLocaleString();
                                }
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Last 30 Days'
                            }
                        }
                    }
                }
            });
        });
    </script>   
</body>
</html> 